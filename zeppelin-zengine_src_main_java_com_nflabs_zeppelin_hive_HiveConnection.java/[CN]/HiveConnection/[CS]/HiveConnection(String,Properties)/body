{
  if (!uri.startsWith(URI_PREFIX)) {
    throw new SQLException("Invalid URL: " + uri,"08S01");
  }
  uri=uri.substring(URI_PREFIX.length());
  if (uri.isEmpty()) {
    try {
      client=new HiveServer.HiveServerHandler();
    }
 catch (    MetaException e) {
      throw new SQLException("Error accessing Hive metastore: " + e.getMessage(),"08S01",e);
    }
  }
 else {
    String[] parts=uri.split("/");
    String[] hostport=parts[0].split(":");
    int port=10000;
    String host=hostport[0];
    try {
      port=Integer.parseInt(hostport[1]);
    }
 catch (    Exception e) {
    }
    transport=new TSocket(host,port);
    TProtocol protocol=new TBinaryProtocol(transport);
    client=new HiveClient(protocol);
    try {
      transport.open();
    }
 catch (    TTransportException e) {
      throw new SQLException("Could not establish connection to " + uri + ": "+ e.getMessage(),"08S01");
    }
  }
  isClosed=false;
  configureConnection();
}
