{
  Connection con;
  try {
    con=getConnection();
    List<URI> resources=getResources();
    for (    URI res : resources) {
      Statement stmt=con.createStatement();
      logger.info("add resource " + res.toString());
      if (res.getPath().endsWith(".jar")) {
        stmt.executeQuery("add JAR " + new File(res.toString()).getAbsolutePath());
      }
 else {
        stmt.executeQuery("add FILE " + new File(res.toString()).getAbsolutePath());
      }
      stmt.close();
    }
    List<ResultSet> results=new LinkedList<ResultSet>();
    String query=getQuery();
    Statement stmt=con.createStatement();
    String[] queries=split(query,';');
    for (    String q : queries) {
      if (q == null || q.trim().length() == 0)       continue;
      logger.info("executeQuery(" + q + ")");
      results.add(stmt.executeQuery(q));
    }
    stmt.close();
    return results;
  }
 catch (  SQLException e) {
    throw new ZException(e);
  }
}
