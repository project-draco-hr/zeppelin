{
  new File(tmpDir.getAbsolutePath() + "/testapp3").mkdir();
  FileUtils.writeStringToFile(new File(tmpDir.getAbsolutePath() + "/testapp3/hql.erb"),"erb template <%= $hql %> option <%= $opt1 %>");
  App app=App.load(new File(tmpDir.getAbsolutePath() + "/testapp3"));
  HashMap<String,String> params=new HashMap<String,String>();
  params.put("opt1","optv1");
  assertEquals("erb template select * from tbl option optv1",app.getQuery(params,"select * from tbl"));
  FileUtils.writeStringToFile(new File(tmpDir.getAbsolutePath() + "/testapp3/hql.erb"),"erb template <%= $hql %> option <%= $opt1 %>");
  app=App.load(new File(tmpDir.getAbsolutePath() + "/testapp3"));
  params=new HashMap<String,String>();
  assertEquals("erb template select * from tbl option ",app.getQuery(params,"select * from tbl"));
}
