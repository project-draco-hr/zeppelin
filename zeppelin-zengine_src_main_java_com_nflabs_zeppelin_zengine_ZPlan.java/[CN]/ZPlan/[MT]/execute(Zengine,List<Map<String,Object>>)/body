{
  LinkedList<Result> results=new LinkedList<Result>();
  ZeppelinDriverFactory driverFactory=zengine.getDriverFactory();
  for (int i=0; i < this.size(); i++) {
    Z zz=this.get(i);
    Map<String,Object> p=new HashMap<String,Object>();
    if (params != null && params.size() >= i + 1) {
      p=params.get(i);
    }
    try {
      zz.withParams(p);
      ZeppelinConnection conn=zz.getConnection();
      if (conn instanceof LazyConnection) {
        ((LazyConnection)conn).initialize(driverFactory);
      }
      zz.execute(conn);
      results.add(zz.result());
      zz.release();
    }
 catch (    Exception e) {
      closeAllConnections();
      throw e;
    }
  }
  closeAllConnections();
  return results;
}
