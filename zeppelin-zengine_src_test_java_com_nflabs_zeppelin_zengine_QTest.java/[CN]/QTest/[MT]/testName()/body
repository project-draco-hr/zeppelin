{
  Path p=new Path(this.ROOT_DIR,"afile");
  FSDataOutputStream o=this.getFileSystem().create(p);
  BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(o));
  bw.write("1\n");
  bw.write("2\n");
  bw.close();
  new Q("drop view if exists test2").execute().result().write(System.out);
  new Q("drop table if exists test").execute().result().write(System.out);
  new Q("create table test(a INT)").execute().result().write(System.out);
  new Q("load data local inpath '" + p.toString() + "' into table test").execute().result().write(System.out);
  Z z=new Q("select count(*) from test").withName("test2").execute();
  assertEquals(new Long(2),new Q("select count(*) from test").execute().result().getRows().get(0)[0]);
  new Q("select * from test2").execute().result().write(System.out);
  assertEquals(new Long(1),new Q("select count(*) from test2").execute().result().getRows().get(0)[0]);
  z.release();
  assertEquals(new Long(1),new Q("select count(*) from test2").execute().result().getRows().get(0)[0]);
}
