{
  ResultSetMetaData metaData=res.getMetaData();
  int numColumns=metaData.getColumnCount();
  columnDef=new ColumnDef[numColumns];
  for (int i=0; i < numColumns; i++) {
    columnDef[i]=new ColumnDef(metaData.getColumnLabel(i + 1),metaData.getColumnType(i + 1),metaData.getColumnTypeName(i + 1));
  }
  this.res=res;
  if (max < 0) {
    this.max=Z.conf().getLong(ConfVars.ZEPPELIN_MAX_RESULT);
  }
 else {
    this.max=max;
  }
}
