{
  repl.interpret("case class Person(name:String, age:Int)");
  repl.interpret("val people = sc.parallelize(Seq(Person(\"moon\", 33), Person(\"jobs\", 51), Person(\"gates\", 51), Person(\"park\", 34)))");
  repl.interpret("people.registerAsTable(\"people\")");
  InterpreterResult ret=sql.interpret("select name, age from people where age < 40");
  System.err.println("RET=" + ret.message());
  assertEquals(InterpreterResult.Code.SUCCESS,ret.code());
  assertEquals(Type.TABLE,ret.type());
  assertEquals("name\tage\nmoon\t33\npark\t34\n",ret.message());
  assertEquals(InterpreterResult.Code.ERROR,sql.interpret("select wrong syntax").code());
}
