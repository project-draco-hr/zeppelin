{
  int numTasks=stage.numTasks();
  int completedTasks=0;
  Object completedTaskInfo=JavaConversions.asJavaMap(sparkListener.stageIdToTasksComplete()).get(stage.id());
  if (completedTaskInfo != null) {
    completedTasks+=(int)completedTaskInfo;
  }
  List<Stage> parents=JavaConversions.asJavaList(stage.parents());
  if (parents != null) {
    for (    Stage s : parents) {
      int[] p=getProgressFromStage(sparkListener,s);
      numTasks+=p[0];
      completedTasks+=p[1];
    }
  }
  return new int[]{numTasks,completedTasks};
}
