{
  if (sqlc == null) {
    String name="org.apache.spark.sql.hive.HiveContext";
    Constructor<?> hc;
    try {
      hc=getClass().getClassLoader().loadClass(name).getConstructor(SparkContext.class);
      sqlc=(SQLContext)hc.newInstance(getSparkContext());
    }
 catch (    NoSuchMethodException|SecurityException|ClassNotFoundException|InstantiationException|IllegalAccessException|IllegalArgumentException|InvocationTargetException e) {
      sqlc=new SQLContext(getSparkContext());
    }
  }
  return sqlc;
}
