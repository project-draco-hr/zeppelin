{
  try {
    Connection con;
    String uriString="jdbc:" + uri.toString();
    logger.info("Create connection " + uriString);
    if (client != null) {
      logger.debug("Create connection from provided client instance");
      con=new HiveConnection(client);
    }
 else     if (isEmpty(uriString)) {
      logger.debug("Create connection from hive configuration");
      con=new HiveConnection(hiveConf());
    }
 else     if (uriString.equals("jdbc:hive://") || uriString.equals("jdbc:hive2://")) {
      logger.debug("Create connection from local mode");
      con=new HiveConnection(localHiveConf());
    }
 else {
      logger.debug("Create connection from given jdbc uri");
      con=DriverManager.getConnection(uriString);
    }
    return new HiveZeppelinConnection(getConf(),con);
  }
 catch (  SQLException e) {
    throw new ZeppelinDriverException(e);
  }
}
