{
  try {
    Connection con;
    String uriString="jdbc:" + uri.toString();
    if (client != null) {
      logger.debug("Create connection from provided client instance");
      con=new HiveConnection(client);
    }
 else     if (isEmpty(uriString)) {
      logger.debug("Create connection from hive configuration");
      con=new HiveConnection(hiveConf());
    }
 else     if (uriString.equals("jdbc:hive://local") || uriString.equals("jdbc:hive2://local")) {
      logger.debug("Create connection from local mode");
      con=new HiveConnection(localHiveConf());
    }
 else {
      logger.debug("Create connection from given jdbc uri");
      Class.forName(getHiveDriverClass(uriString));
      con=DriverManager.getConnection(uriString);
    }
    return new HiveZeppelinConnection(con);
  }
 catch (  SQLException e) {
    throw new ZeppelinDriverException(e);
  }
catch (  ClassNotFoundException e) {
    throw new ZeppelinDriverException(e);
  }
}
