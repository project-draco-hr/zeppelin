{
  if (driver == null) {
    try {
      FirefoxBinary ffox=new FirefoxBinary();
      if ("true".equals(System.getenv("TRAVIS"))) {
        ffox.setEnvironmentProperty("DISPLAY",":99");
      }
      FirefoxProfile profile=new FirefoxProfile();
      driver=new FirefoxDriver(ffox,profile);
    }
 catch (    Exception e) {
      LOG.error("Starting Firefox failed",e);
    }
  }
  if (driver == null) {
    try {
      driver=new ChromeDriver();
    }
 catch (    Exception e) {
      LOG.error("Starting Chrome failed",e);
    }
  }
  if (driver == null) {
    try {
      driver=new SafariDriver();
    }
 catch (    Exception e) {
      LOG.error("Starting Safari failed",e);
    }
  }
  String url;
  if (System.getProperty("url") != null) {
    url=System.getProperty("url");
  }
 else {
    url="http://localhost:8080";
  }
  long start=System.currentTimeMillis();
  boolean loaded=false;
  driver.get(url);
  while (System.currentTimeMillis() - start < 60 * 1000) {
    try {
      WebElement element=pollingWait(By.partialLinkText("Create new note"),MAX_BROWSER_TIMEOUT_SEC);
      loaded=element.isDisplayed();
      break;
    }
 catch (    TimeoutException e) {
      driver.navigate().to(url);
    }
  }
  if (loaded == false) {
    fail();
  }
}
