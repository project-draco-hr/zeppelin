{
  WebDriver driver=null;
  if (driver == null) {
    try {
      FirefoxBinary ffox=new FirefoxBinary();
      if ("true".equals(System.getenv("TRAVIS"))) {
        ffox.setEnvironmentProperty("DISPLAY",":99");
      }
      FirefoxProfile profile=new FirefoxProfile();
      driver=new FirefoxDriver(ffox,profile);
    }
 catch (    Exception e) {
    }
  }
  if (driver == null) {
    try {
      driver=new ChromeDriver();
    }
 catch (    Exception e) {
    }
  }
  if (driver == null) {
    try {
      driver=new SafariDriver();
    }
 catch (    Exception e) {
    }
  }
  String url;
  if (System.getProperty("url") != null) {
    url=System.getProperty("url");
  }
 else {
    url="http://localhost:8080";
  }
  long start=System.currentTimeMillis();
  boolean loaded=false;
  driver.get(url);
  while (System.currentTimeMillis() - start < 60 * 1000) {
    try {
      (new WebDriverWait(driver,5)).until(new ExpectedCondition<Boolean>(){
        @Override public Boolean apply(        WebDriver d){
          return d.findElement(By.partialLinkText("Start")).isDisplayed();
        }
      }
);
      loaded=true;
      break;
    }
 catch (    TimeoutException e) {
      driver.navigate().to(url);
    }
  }
  if (loaded == false) {
    fail();
  }
  return driver;
}
