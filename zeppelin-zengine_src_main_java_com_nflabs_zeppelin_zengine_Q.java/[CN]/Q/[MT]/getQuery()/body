{
  ByteArrayInputStream ins=new ByteArrayInputStream(query.getBytes());
  BufferedReader erb=new BufferedReader(new InputStreamReader(ins));
  ZContext zContext=new ZContext((prev() == null) ? null : prev().name(),null,params);
  String q=getQuery(erb,zContext);
  try {
    ins.close();
  }
 catch (  IOException e) {
  }
  String tableCreation=null;
  if (name == null) {
    tableCreation="";
  }
 else {
    if (cache) {
      tableCreation="CREATE TABLE " + name + " AS ";
    }
 else {
      tableCreation="CREATE VIEW " + name + " AS ";
    }
  }
  return tableCreation + q;
}
