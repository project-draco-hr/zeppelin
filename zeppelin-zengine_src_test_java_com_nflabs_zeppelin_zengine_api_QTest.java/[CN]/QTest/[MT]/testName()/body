{
  Path p=genTestDataFile();
  new Q("drop view if exists test2",z,drv).execute().result().write(System.out);
  new Q("drop table if exists test",z,drv).execute().result().write(System.out);
  new Q("create table test(a INT)",z,drv).execute().result().write(System.out);
  new Q("load data local inpath '" + p.toString() + "' into table test",z,drv).execute().result().write(System.out);
  Z q=new Q("select count(*) from test",z,drv).withName("test2").execute();
  assertEquals(new Long(2),new Q("select count(*) from test",z,drv).execute().result().getRows().get(0)[0]);
  new Q("select * from test2",z,drv).execute().result().write(System.out);
  assertEquals(new Long(1),new Q("select count(*) from test2",z,drv).execute().result().getRows().get(0)[0]);
  q.release();
  assertEquals(new Long(1),new Q("select count(*) from test2",z,drv).execute().result().getRows().get(0)[0]);
}
