{
  logger.info("Create repl {} from {}",className,dirName);
  ClassLoader oldcl=Thread.currentThread().getContextClassLoader();
  try {
    logger.info("Reading " + conf.getString(ConfVars.ZEPPELIN_REPL_DIR) + "/"+ dirName);
    File path=new File(conf.getString(ConfVars.ZEPPELIN_REPL_DIR) + "/" + dirName);
    URL[] urls=recursiveBuildLibList(path);
    URLClassLoader cl=new URLClassLoader(urls,oldcl);
    Thread.currentThread().setContextClassLoader(cl);
    Class<Repl> replClass=(Class<Repl>)cl.loadClass(className);
    Constructor<Repl> constructor=replClass.getConstructor(new Class[]{Properties.class});
    Repl repl=constructor.newInstance(property);
    return new ClassloaderRepl(repl,cl,property);
  }
 catch (  SecurityException e) {
    throw new ReplException(e);
  }
catch (  NoSuchMethodException e) {
    throw new ReplException(e);
  }
catch (  IllegalArgumentException e) {
    throw new ReplException(e);
  }
catch (  InstantiationException e) {
    throw new ReplException(e);
  }
catch (  IllegalAccessException e) {
    throw new ReplException(e);
  }
catch (  InvocationTargetException e) {
    throw new ReplException(e);
  }
catch (  ClassNotFoundException e) {
    throw new ReplException(e);
  }
catch (  MalformedURLException e) {
    throw new ReplException(e);
  }
 finally {
    Thread.currentThread().setContextClassLoader(oldcl);
  }
}
