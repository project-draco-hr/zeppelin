{
synchronized (referenceCount) {
    if (executor == null) {
      try {
        port=RemoteInterpreterUtils.findRandomAvailablePortOnAllLocalInterfaces();
      }
 catch (      IOException e1) {
        throw new InterpreterException(e1);
      }
      CommandLine cmdLine=CommandLine.parse(interpreterRunner);
      cmdLine.addArgument("-d",false);
      cmdLine.addArgument(interpreterDir,false);
      cmdLine.addArgument("-p",false);
      cmdLine.addArgument(Integer.toString(port),false);
      cmdLine.addArgument("-l",false);
      cmdLine.addArgument(localRepoDir,false);
      executor=new DefaultExecutor();
      watchdog=new ExecuteWatchdog(ExecuteWatchdog.INFINITE_TIMEOUT);
      executor.setWatchdog(watchdog);
      running=true;
      try {
        Map procEnv=EnvironmentUtils.getProcEnvironment();
        procEnv.putAll(env);
        logger.info("Run interpreter process {}",cmdLine);
        executor.execute(cmdLine,procEnv,this);
      }
 catch (      IOException e) {
        running=false;
        throw new InterpreterException(e);
      }
      long startTime=System.currentTimeMillis();
      while (System.currentTimeMillis() - startTime < connectTimeout) {
        if (RemoteInterpreterUtils.checkIfRemoteEndpointAccessible("localhost",port)) {
          break;
        }
 else {
          try {
            Thread.sleep(500);
          }
 catch (          InterruptedException e) {
            logger.error("Exception in RemoteInterpreterProcess while synchronized reference " + "Thread.sleep",e);
          }
        }
      }
      clientPool=new GenericObjectPool<Client>(new ClientFactory("localhost",port));
      remoteInterpreterEventPoller.setInterpreterGroup(interpreterGroup);
      remoteInterpreterEventPoller.setInterpreterProcess(this);
      remoteInterpreterEventPoller.start();
    }
    return referenceCount.incrementAndGet();
  }
}
