{
  if (v == null) {
    if (defaultValue != null) {
      return defaultValue;
    }
 else {
      throw new ParamSpecException("Value can not be null");
    }
  }
 else {
    if (defaultValue != null) {
      if (compare(defaultValue,v) == 0) {
        return v;
      }
    }
    if (options != null) {
      for (      Option<T> o : options) {
        if (compare(o.getValue(),v) == 0) {
          return v;
        }
      }
    }
    if (allowAny == true) {
      if (range != null) {
        Option<T> from=range.from();
        Option<T> to=range.to();
        if ((from == null || compare(from.getValue(),v) >= 0) && (to == null || compare(v,to.getValue()) >= 0)) {
          return v;
        }
 else {
          throw new ParamSpecException("Value not in range");
        }
      }
 else {
        return v;
      }
    }
 else {
      throw new ParamSpecException("Any value is not allowed");
    }
  }
}
