{
  if (executed == true)   return this;
  initialize();
  connection=connection(conn);
  if (prev() != null) {
    prev().execute();
  }
  String query=getQuery();
  if (query != null) {
    String[] queries=Util.split(query,';');
    for (int i=0; i < queries.length; i++) {
      String q=queries[i];
      if (i == queries.length - 1) {
        if (name() == null) {
          lastQueryResult=executeQuery(conn,q,maxResult);
        }
 else {
          if (isSaveableQuery(q) == false) {
            throw new ZException("Can not save query " + q + " into table "+ name());
          }
          try {
            if (isTable()) {
              lastQueryResult=connection(conn).createTableFromQuery(name(),q);
            }
 else {
              lastQueryResult=connection(conn).createViewFromQuery(name(),q);
            }
          }
 catch (          ZeppelinDriverException e) {
            throw new ZException(e);
          }
        }
      }
 else {
        lastQueryResult=executeQuery(connection,q,maxResult);
      }
    }
  }
  webEnabled=isWebEnabled();
  executed=true;
  return this;
}
