{
  try {
    Connection con;
    if (client != null) {
      logger.debug("Create connection from provided client instance");
      con=new HiveConnection(client);
    }
 else     if (getConnectionUri() == null || getConnectionUri().trim().length() == 0) {
      logger.debug("Create connection from hive configuration");
      con=new HiveConnection(hiveConf());
    }
 else     if (getConnectionUri().equals("jdbc:hive://")) {
      logger.debug("Create connection from local mode");
      con=new HiveConnection(localHiveConf());
    }
 else {
      logger.debug("Create connection from given jdbc uri");
      Class.forName(getHiveDriverClass());
      con=DriverManager.getConnection(getConnectionUri());
    }
    return new HiveZeppelinConnection(con);
  }
 catch (  SQLException e) {
    throw new ZeppelinDriverException(e);
  }
catch (  ClassNotFoundException e) {
    throw new ZeppelinDriverException(e);
  }
}
