{
  File dir=new File(tmpPath.getAbsolutePath() + "/data");
  dir.mkdir();
  File data=new File(tmpPath.getAbsolutePath() + "/data/a");
  FileOutputStream out=new FileOutputStream(data);
  out.write("a,1\n".getBytes());
  out.write("b,2\n".getBytes());
  out.write("c,3".getBytes());
  out.flush();
  out.close();
  ZeppelinConfiguration conf=new ZeppelinConfiguration();
  ZeppelinRuntime zr=new ZeppelinRuntime(conf,new User("test"));
  ZDD zdd=zr.fromText(new Schema("test",new ColumnDesc[]{new ColumnDesc("key",DataTypes.STRING),new ColumnDesc("value",DataTypes.INT)}),dir.toURI(),',');
  assertEquals(3,zdd.rdd().count());
}
