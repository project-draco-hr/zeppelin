{
  this.schedulerFactory=new SchedulerFactory();
  Zengine z=new Zengine();
  z.configure();
  if (z.useFifoJobScheduler()) {
    this.analyzeSessionManager=new ZQLJobManager(schedulerFactory.createOrGetFIFOScheduler("analyze"),z.fs(),z.getConf().getString(ConfVars.ZEPPELIN_JOB_DIR));
  }
 else {
    this.analyzeSessionManager=new ZQLJobManager(schedulerFactory.createOrGetParallelScheduler("analyze",100),z.fs(),z.getConf().getString(ConfVars.ZEPPELIN_JOB_DIR));
  }
  this.zan=new ZAN(z.getConf().getString(ConfVars.ZEPPELIN_ZAN_REPO),z.getConf().getString(ConfVars.ZEPPELIN_ZAN_LOCAL_REPO),z.getConf().getString(ConfVars.ZEPPELIN_ZAN_SHARED_REPO),z.fs());
  this.zanJobManager=new ZANJobManager(zan,schedulerFactory.createOrGetFIFOScheduler("analyze"));
}
