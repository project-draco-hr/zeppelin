{
  notebookWsServer=new NotebookServer();
  String maxTextMessageSize=conf.getWebsocketMaxTextMessageSize();
  final ServletHolder servletHolder=new ServletHolder(notebookWsServer);
  servletHolder.setInitParameter("maxTextMessageSize",maxTextMessageSize);
  final ServletContextHandler cxfContext=new ServletContextHandler(ServletContextHandler.SESSIONS);
  cxfContext.setSessionHandler(new SessionHandler());
  cxfContext.setContextPath(conf.getServerContextPath());
  cxfContext.addServlet(servletHolder,"/ws/*");
  cxfContext.addFilter(new FilterHolder(CorsFilter.class),"/*",EnumSet.allOf(DispatcherType.class));
  return cxfContext;
}
