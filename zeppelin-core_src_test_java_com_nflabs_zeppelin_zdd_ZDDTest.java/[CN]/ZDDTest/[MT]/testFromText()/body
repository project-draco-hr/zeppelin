{
  File dir=new File(tmpPath.getAbsolutePath() + "/data");
  dir.mkdir();
  File data=new File(tmpPath.getAbsolutePath() + "/data/a");
  FileOutputStream out=new FileOutputStream(data);
  out.write("a,1\n".getBytes());
  out.write("b,2\n".getBytes());
  out.write("c,3".getBytes());
  out.flush();
  out.close();
  ZDD zdd=ZDD.createFromText(zr,"test",new Schema(new ColumnDesc[]{new ColumnDesc("key",DataTypes.STRING),new ColumnDesc("value",DataTypes.INT)}),dir.getAbsolutePath(),',');
  assertEquals(3,zdd.tableRdd().count());
  assertEquals(dir.getAbsolutePath().toString(),zdd.getLocation());
  ZDD select=zr.fromTable(zdd.name());
  assertEquals("a",select.tableRdd().first().getString(0));
  assertEquals("file:" + dir.getAbsolutePath().toString(),select.getLocation());
  ZDD sum=zr.fromSql("test1","select sum(value) from " + zdd.name());
  assertEquals(new Long(6),sum.tableRdd().first().getLong(0));
}
