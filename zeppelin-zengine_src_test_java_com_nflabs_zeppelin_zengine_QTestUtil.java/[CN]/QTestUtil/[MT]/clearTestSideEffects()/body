{
  for (  String dbName : db.getAllDatabases()) {
    db.setCurrentDatabase(dbName);
    for (    String tblName : db.getAllTables()) {
      if (!DEFAULT_DATABASE_NAME.equals(dbName) || !srcTables.contains(tblName)) {
        Table tblObj=db.getTable(tblName);
        if (tblObj.isIndexTable()) {
          continue;
        }
        db.dropTable(dbName,tblName);
      }
 else {
        List<Index> indexes=db.getIndexes(dbName,tblName,(short)-1);
        if (indexes != null && indexes.size() > 0) {
          for (          Index index : indexes) {
            db.dropIndex(dbName,tblName,index.getIndexName(),true);
          }
        }
      }
    }
    if (!DEFAULT_DATABASE_NAME.equals(dbName)) {
      db.dropDatabase(dbName);
    }
  }
  Hive.get().setCurrentDatabase(DEFAULT_DATABASE_NAME);
  List<String> roleNames=db.getAllRoleNames();
  for (  String roleName : roleNames) {
    db.dropRole(roleName);
  }
  conf=new HiveConf(Driver.class);
  initConf();
  setup.preTest(conf);
}
