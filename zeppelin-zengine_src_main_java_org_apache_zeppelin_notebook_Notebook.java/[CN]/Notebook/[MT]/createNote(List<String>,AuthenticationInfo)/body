{
  Note note=new Note(notebookRepo,replFactory,jobListenerFactory,notebookIndex,credentials,this);
synchronized (notes) {
    notes.put(note.id(),note);
  }
  if (interpreterIds != null) {
    bindInterpretersToNote(note.id(),interpreterIds);
    note.putDefaultReplName();
  }
  notebookIndex.addIndexDoc(note);
  note.persist(subject);
  fireNoteCreateEvent(note);
  return note;
}
