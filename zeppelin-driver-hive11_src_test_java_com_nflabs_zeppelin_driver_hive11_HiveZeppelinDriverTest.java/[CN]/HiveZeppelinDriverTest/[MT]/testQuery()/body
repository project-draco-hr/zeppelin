{
  HiveZeppelinDriver driver=new HiveZeppelinDriver();
  driver.setClassLoader(Thread.currentThread().getContextClassLoader());
  ZeppelinConnection conn=driver.getConnection(new URI("hive2://local"));
  driver.setClient(client);
  Result res=conn.query("create table if not exists test(a INT)");
  res=conn.query("show tables");
  assertEquals("test",res.getRows().get(0)[0]);
  FileOutputStream out=new FileOutputStream(new File("/tmp/warehouse/test/data"));
  BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(out));
  bw.write("1\n");
  bw.write("2\n");
  bw.close();
  res=conn.query("select count(*) from test");
  assertEquals(new Long(2),res.getRows().get(0)[0]);
}
