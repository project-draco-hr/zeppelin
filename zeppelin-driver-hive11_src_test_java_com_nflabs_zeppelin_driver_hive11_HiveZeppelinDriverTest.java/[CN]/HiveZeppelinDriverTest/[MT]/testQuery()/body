{
  HiveZeppelinDriver driver=new HiveZeppelinDriver(ZeppelinConfiguration.create(),new URI("jdbc:hive2://"),new URLClassLoader(new URL[]{},Thread.currentThread().getContextClassLoader()));
  driver.setClient(client);
  Result res=driver.query("create table if not exists test(a INT)");
  res=driver.query("show tables");
  assertEquals("test",res.getRows().get(0)[0]);
  FileOutputStream out=new FileOutputStream(new File("/tmp/warehouse/test/data"));
  BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(out));
  bw.write("1\n");
  bw.write("2\n");
  bw.close();
  res=driver.query("select count(*) from test");
  assertEquals(new Long(2),res.getRows().get(0)[0]);
}
