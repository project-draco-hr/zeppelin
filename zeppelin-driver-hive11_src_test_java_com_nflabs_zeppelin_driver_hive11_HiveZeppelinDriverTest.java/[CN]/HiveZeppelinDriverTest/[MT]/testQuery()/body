{
  HiveZeppelinDriver driver=new HiveZeppelinDriver();
  driver.setConf(ZeppelinConfiguration.create());
  ZeppelinConnection conn=driver.getConnection("hive2://");
  driver.setClient(client);
  Result res=conn.query("create database if not exists default");
  res=conn.query("create table if not exists test(a INT)");
  res=conn.query("show tables");
  assertEquals("test",res.getRows().get(0)[0]);
  FileOutputStream out=new FileOutputStream(new File(ROOT_DIR.getName() + "/warehouse/test/data"));
  BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(out));
  for (int i=1; i <= 200; i++) {
    bw.write(i + "\n");
  }
  bw.close();
  res=conn.query("select count(*) from test");
  assertEquals(new Long(200),res.getRows().get(0)[0]);
  res=conn.query("select * from test");
  assertEquals(200,res.getRows().size());
  conn.query("drop table test");
}
