{
  List<ArtifactResult> listOfArtifact;
  if (recursive) {
    listOfArtifact=getArtifactsWithDep(artifact);
  }
 else {
    listOfArtifact=getArtifact(artifact);
  }
  Iterator<ArtifactResult> it=listOfArtifact.iterator();
  while (it.hasNext()) {
    Artifact a=it.next().getArtifact();
    String gav=a.getGroupId() + ":" + a.getArtifactId()+ ":"+ a.getVersion();
    for (    String exclude : exclusions) {
      if (gav.startsWith(exclude)) {
        it.remove();
        break;
      }
    }
  }
  List<URL> newClassPathList=new LinkedList<URL>();
  List<File> files=new LinkedList<File>();
  for (  ArtifactResult artifactResult : listOfArtifact) {
    logger.info("Load " + artifactResult.getArtifact().getGroupId() + ":"+ artifactResult.getArtifact().getArtifactId()+ ":"+ artifactResult.getArtifact().getVersion());
    newClassPathList.add(artifactResult.getArtifact().getFile().toURI().toURL());
    files.add(artifactResult.getArtifact().getFile());
  }
  updateCompilerClassPath(newClassPathList.toArray(new URL[0]));
  updateRuntimeClassPath(newClassPathList.toArray(new URL[0]));
  if (addSparkContext) {
    for (    File f : files) {
      sc.addJar(f.getAbsolutePath());
    }
  }
}
