{
  List<Z> zList=new LinkedList<Z>();
  Z currentZ=null;
  String[] t=Util.split(stmts,op,true);
  String currentOp=null;
  for (int i=0; i < t.length; i++) {
    String stmt=t[i];
    stmt=stmt.trim();
    boolean operatorFound=false;
    for (    String o : op) {
      if (o.equals(stmt)) {
        if (currentOp != null) {
          throw new ZQLException("Operator " + o + " can not come after "+ currentOp);
        }
        currentOp=o;
        operatorFound=true;
        break;
      }
    }
    if (operatorFound == true) {
      continue;
    }
    if (currentZ == null && currentOp != null) {
      throw new ZQLException(currentOp + " can not be at the beginning");
    }
    if (op[2].equals(currentOp)) {
      throw new ZQLException("redirection (append) not implemented");
    }
 else     if (op[3].equals(currentOp)) {
      if (currentZ != null) {
        RedirectStatement red=new RedirectStatement(stmt);
        currentZ.withName(red.getName());
        currentZ.withTable(red.isTable());
        currentOp=null;
        continue;
      }
 else {
        throw new ZQLException("Can not redirect empty");
      }
    }
    Z z=null;
    try {
      z=loadL(stmt);
    }
 catch (    ZException e) {
    }
    if (z == null) {
      Q q;
      try {
        q=new Q(stmt);
      }
 catch (      ZException e) {
        throw new ZQLException(e);
      }
      if (stmt.toLowerCase().trim().startsWith("select") == false && stmt.toLowerCase().trim().startsWith("map") == false) {
        q.withName(null);
      }
      z=q;
    }
    if (currentZ == null) {
      currentZ=z;
    }
 else     if (currentOp == null) {
      throw new ZQLException("Assert! Statment does not have operator in between");
    }
 else     if (currentOp.equals(op[0])) {
      zList.add(currentZ);
      currentZ=z;
      currentOp=null;
    }
 else     if (currentOp.equals(op[1])) {
      currentZ=currentZ.pipe(z);
      currentOp=null;
    }
  }
  if (currentZ != null) {
    zList.add(currentZ);
  }
  return zList;
}
