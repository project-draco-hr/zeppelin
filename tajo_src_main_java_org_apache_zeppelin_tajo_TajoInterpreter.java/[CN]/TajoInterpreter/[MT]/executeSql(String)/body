{
  try {
    if (exceptionOnConnect != null) {
      return new InterpreterResult(Code.ERROR,exceptionOnConnect.getMessage());
    }
    statement=connection.createStatement();
    StringBuilder msg=null;
    if (StringUtils.containsIgnoreCase(sql,"EXPLAIN ")) {
      msg=new StringBuilder();
    }
 else {
      msg=new StringBuilder("%table ");
    }
    ResultSet res=statement.executeQuery(sql);
    try {
      ResultSetMetaData md=res.getMetaData();
      for (int i=1; i < md.getColumnCount() + 1; i++) {
        if (i == 1) {
          msg.append(md.getColumnName(i));
        }
 else {
          msg.append("\t" + md.getColumnName(i));
        }
      }
      msg.append("\n");
      while (res.next()) {
        for (int i=1; i < md.getColumnCount() + 1; i++) {
          msg.append(res.getString(i) + "\t");
        }
        msg.append("\n");
      }
    }
  finally {
      try {
        res.close();
        statement.close();
      }
  finally {
        statement=null;
      }
    }
    InterpreterResult interpreterResult=new InterpreterResult(Code.SUCCESS,msg.toString());
    return interpreterResult;
  }
 catch (  SQLException ex) {
    logger.error("Can not run " + sql,ex);
    return new InterpreterResult(Code.ERROR,ex.getMessage());
  }
}
