{
  repl.interpret("case class Person(name:String, age:Int)");
  repl.interpret("val people = sc.parallelize(Seq(Person(\"moon\", 33), Person(\"jobs\", 51), Person(\"gates\", 51), Person(\"park\", 34)))");
  repl.interpret("people.registerAsTable(\"people\")");
  System.err.println(repl.interpret("val oldguys = sqlc.sql(\"SELECT name FROM people WHERE age>40\")").message());
  assertEquals("res6: Array[org.apache.spark.sql.Row] = Array([jobs], [gates])\n",repl.interpret("oldguys.collect()").message());
}
