{
  File dir=new File(tmpPath.getAbsolutePath() + "/data");
  dir.mkdir();
  File data=new File(tmpPath.getAbsolutePath() + "/data/a");
  FileOutputStream out=new FileOutputStream(data);
  out.write("a,1\n".getBytes());
  out.write("b,2\n".getBytes());
  out.write("c,3".getBytes());
  out.flush();
  out.close();
  ZeppelinConfiguration conf=new ZeppelinConfiguration();
  ZeppelinRuntime zr=new ZeppelinRuntime(conf,new User("test"));
  ZDD zdd=ZDD.createFromText(zr,"test",new Schema(new ColumnDesc[]{new ColumnDesc("key",DataTypes.STRING),new ColumnDesc("value",DataTypes.INT)}),dir.getAbsolutePath(),',');
  zdd.evaluate();
  Sql sql=new Sql(zr);
  Output output=sql.run(new Input(new ZDD[]{zdd},new Param[]{new Param<String>("query","select count(*) from test")},null));
  ZDD[] outputData=output.getData();
  assertEquals(1,outputData.length);
  assertEquals(new Long(3),(((shark.api.Row[])(outputData[0].rdd().take(1)))[0].getLong(0)));
  zr.destroy();
}
