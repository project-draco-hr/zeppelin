{
  tmpDir=new File(System.getProperty("java.io.tmpdir") + "/ZeppelinLTest_" + System.currentTimeMillis());
  tmpDir.mkdir();
  dataDir=new File(System.getProperty("java.io.tmpdir") + "/ZeppelinLTest_" + System.currentTimeMillis()+ "/data");
  dataDir.mkdir();
  System.setProperty("hive.local.warehouse","file://" + dataDir.getAbsolutePath());
  System.setProperty(ConfVars.ZEPPELIN_ZAN_LOCAL_REPO.getVarName(),tmpDir.toURI().toString());
  System.setProperty(ConfVars.ZEPPELIN_JOB_DIR.getVarName(),tmpDir.getAbsolutePath());
  ZeppelinConfiguration conf=ZeppelinConfiguration.create();
  MockDriverFactory driverFactory=new MockDriverFactory();
  z=new Zengine(conf,driverFactory);
  this.schedulerFactory=new SchedulerFactory();
  fs=FileSystem.get(new org.apache.hadoop.conf.Configuration());
  this.jm=new ZQLJobManager(z,fs,schedulerFactory.createOrGetFIFOScheduler("analyze"),z.getConf().getString(ConfVars.ZEPPELIN_JOB_DIR));
}
