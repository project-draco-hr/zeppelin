{
  Properties properties=new Properties();
  properties.setProperty("common.max_count","1000");
  properties.setProperty("common.max_retry","3");
  properties.setProperty("default.driver","org.h2.Driver");
  properties.setProperty("default.url",getJdbcConnection());
  properties.setProperty("default.user","");
  properties.setProperty("default.password","");
  HiveInterpreter t=new HiveInterpreter(properties);
  t.open();
  InterpreterResult interpreterResult=t.interpret("select * from test_table",new InterpreterContext("","1","","",null,null,null,null,null,null));
  assertEquals("ID\tNAME\na\ta_name\nb\tb_name\n",interpreterResult.message());
  t.getConnection("default").close();
  interpreterResult=t.interpret("select * from test_table",new InterpreterContext("","1","","",null,null,null,null,null,null));
  assertEquals("ID\tNAME\na\ta_name\nb\tb_name\n",interpreterResult.message());
}
